{#-
  This file was automatically generated - do not edit
-#}
{% set disqus = config.extra.disqus %} {% if page and page.meta and page.meta.disqus is string %} {% set disqus = page.meta.disqus
  %} {% endif %}
{% set copyright = config.extra.copyright %} {% if page and page.meta and page.meta.copyright is string %} {% set copyright = page.meta.copyright
  %} {% endif %}
{% set authors = 'OI-wiki' %} {% if page and page.meta and page.meta.author is string %} {% set authors = page.meta.author
  %} {% endif %}
<hr><blockquote class="page-copyright">
  <span><i class="md-icon">build</i>本页面最近更新：</span><span class="facts_modified"></span>，<a class="edit_history">更新历史</a><br>
  <span><i class="md-icon">edit</i>发现错误？想一起完善？ <a href="{{ page.edit_url }}" title="{{ lang.t('edit.link.title') }}" class="page_edit_url">在 GitHub 上编辑此页！</a></span><br>
  <span><i class="md-icon">people</i>本页面贡献者：</span><span class="page_contributors">{{ authors }}</span><br>
  <span><i class="md-icon">copyright</i>本页面的全部内容在 <strong>{{ copyright }}</strong> 协议之条款下提供，附加条款亦可能应用</span>
</blockquote>
{% if not page.is_homepage and disqus %}
{% set pageID = page.title | default("404", true) %}
<h2 id="__comments" data-no-instant>{{ lang.t("meta.comments") }}</h2>
<form id="gitalk-form" onsubmit="return!1" data-no-instant>
<div id="gitalk-container" data-no-instant>评论加载中 ...</div>
</form>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/OI-wiki/gitalk@master/dist/gitalk.css" media="print" onload='this.media="all"'>

<script>
/* Lazyload Gitalk | Sukka | <https://skk.moe> */
// Based on: https://blog.skk.moe/post/prevent-disqus-from-slowing-your-site/

(function (window, document, navigator) {
  function loadGitalk() {
    var s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/gh/OI-wiki/gitalk@master/dist/gitalk.min.js';
    (document.head || document.body).appendChild(s);
    s.onload = function () {
      const gitalk = new Gitalk({
        id: '{{ page.title | default("404", true)  }}',
        owner: 'OI-wiki',
        repo: 'gitment',
        admin: ['Ir1d', 'cjsoft', 'TrisolarisHD', 'Xeonacid', 'sshwy'],
        clientID: 'd6a911c8fba0194626d4',
        clientSecret: '867ec7e13cc99b420bd147cbb62d5cfec271ba81',
        distractionFreeMode: false,
        pagerDirection: 'first'
      });
      gitalk.render('gitalk-container');
    };
  }

  var runningOnBrowser = typeof window !== 'undefined';
  var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== 'undefined' && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
  var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;

  setTimeout(function () {
    if (!isBot && supportsIntersectionObserver) {
      var gitalk_observer = new IntersectionObserver(function(entries) {
        if (entries[0].isIntersecting) {
          loadGitalk();
          gitalk_observer.disconnect();
        }
      }, { threshold: [0] });
      gitalk_observer.observe(document.getElementById('gitalk-container'));
    } else {
      loadGitalk();
    }
  }, 1);
})(window, document, navigator);

</script>
{% endif %}
